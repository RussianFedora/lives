diff -uNdr lives-2.2.3_old/lives-plugins/plugins/decoders/asf_decoder.c lives-2.2.3_new/lives-plugins/plugins/decoders/asf_decoder.c
--- lives-2.2.3_old/lives-plugins/plugins/decoders/asf_decoder.c	2014-03-23 16:53:06.000000000 +0400
+++ lives-2.2.3_new/lives-plugins/plugins/decoders/asf_decoder.c	2014-04-18 09:15:18.352544931 +0400
@@ -63,10 +63,10 @@
 #include <libavutil/avstring.h>
 
 #include "decplugin.h"
-#include "asf_decoder.h"
-
 #include "libav_helper.h"
 
+#include "asf_decoder.h"
+
 static enum CodecID ff_codec_get_id(const AVCodecTag *tags, unsigned int tag)
 {
   int i;
diff -uNdr lives-2.2.3_old/lives-plugins/plugins/decoders/avformat_decoder.c lives-2.2.3_new/lives-plugins/plugins/decoders/avformat_decoder.c
--- lives-2.2.3_old/lives-plugins/plugins/decoders/avformat_decoder.c	2014-03-23 17:00:20.000000000 +0400
+++ lives-2.2.3_new/lives-plugins/plugins/decoders/avformat_decoder.c	2014-04-18 09:15:18.430546680 +0400
@@ -33,10 +33,10 @@
 #include <libavutil/samplefmt.h>
 #include <libavutil/mathematics.h>
 
-#include "avformat_decoder.h"
-
 #include "libav_helper.h"
 
+#include "avformat_decoder.h"
+
 const char *plugin_version="LiVES avformat decoder version 1.0";
 
 static pthread_mutex_t avcodec_mutex=PTHREAD_MUTEX_INITIALIZER;
diff -uNdr lives-2.2.3_old/lives-plugins/plugins/decoders/flv_decoder.c lives-2.2.3_new/lives-plugins/plugins/decoders/flv_decoder.c
--- lives-2.2.3_old/lives-plugins/plugins/decoders/flv_decoder.c	2014-03-23 16:54:09.000000000 +0400
+++ lives-2.2.3_new/lives-plugins/plugins/decoders/flv_decoder.c	2014-04-18 09:15:18.537549079 +0400
@@ -64,10 +64,10 @@
 #include <pthread.h>
 
 #include "decplugin.h"
-#include "flv_decoder.h"
-
 #include "libav_helper.h"
 
+#include "flv_decoder.h"
+
 static index_container_t **indices;
 static int nidxc;
 static pthread_mutex_t indices_mutex;
diff -uNdr lives-2.2.3_old/lives-plugins/plugins/decoders/mkv_decoder.c lives-2.2.3_new/lives-plugins/plugins/decoders/mkv_decoder.c
--- lives-2.2.3_old/lives-plugins/plugins/decoders/mkv_decoder.c	2014-03-23 17:02:57.000000000 +0400
+++ lives-2.2.3_new/lives-plugins/plugins/decoders/mkv_decoder.c	2014-04-18 09:15:18.186541208 +0400
@@ -76,10 +76,10 @@
 #include <libavutil/dict.h>
 
 
-#include "mkv_decoder.h"
-
 #include "libav_helper.h"
 
+#include "mkv_decoder.h"
+
 #if CONFIG_ZLIB
 #include <zlib.h>
 #endif
diff -uNdr lives-2.2.3_old/lives-plugins/plugins/decoders/mpegts_decoder.c lives-2.2.3_new/lives-plugins/plugins/decoders/mpegts_decoder.c
--- lives-2.2.3_old/lives-plugins/plugins/decoders/mpegts_decoder.c	2014-03-23 16:59:45.000000000 +0400
+++ lives-2.2.3_new/lives-plugins/plugins/decoders/mpegts_decoder.c	2014-04-15 09:44:48.517654449 +0400
@@ -67,10 +67,10 @@
 
 #include <pthread.h>
 
-#include "mpegts_decoder.h"
-
 #include "libav_helper.h"
 
+#include "mpegts_decoder.h"
+
 static index_container_t **indices;
 static int nidxc;
 static pthread_mutex_t indices_mutex;
@@ -2633,73 +2633,6 @@
 
 
 
-/* XXX: suppress the packet queue */
-static void flush_packet_queue(AVFormatContext *s)
-{
-  AVPacketList *pktl;
-
-  for(;;) {
-    pktl = s->packet_buffer;
-    if (!pktl)
-      break;
-    s->packet_buffer = pktl->next;
-    av_free_packet(&pktl->pkt);
-    av_free(pktl);
-  }
-  while(s->raw_packet_buffer){
-    pktl = s->raw_packet_buffer;
-    s->raw_packet_buffer = pktl->next;
-    av_free_packet(&pktl->pkt);
-    av_free(pktl);
-  }
-  s->packet_buffer_end=
-    s->raw_packet_buffer_end= NULL;
-  s->raw_packet_buffer_remaining_size = RAW_PACKET_BUFFER_SIZE;
-}
-
-
-
-
-
-/**
- * Flush the frame reader.
- */
-void ff_read_frame_flush(AVFormatContext *s)
-{
-  AVStream *st;
-  int i, j;
-
-  flush_packet_queue(s);
-
-  /* for each stream, reset read state */
-  for(i = 0; i < s->nb_streams; i++) {
-    st = s->streams[i];
-
-    if (st->parser) {
-      av_parser_close(st->parser);
-      st->parser = NULL;
-      //av_free_packet(&st->cur_pkt);
-    }
-    st->last_IP_pts = AV_NOPTS_VALUE;
-    if(st->first_dts == AV_NOPTS_VALUE) st->cur_dts = 0;
-    else                                st->cur_dts = AV_NOPTS_VALUE; /* we set the current DTS to an unspecified origin */
-    st->reference_dts = AV_NOPTS_VALUE;
-    /* fail safe */
-    //st->cur_ptr = NULL;
-    //st->cur_len = 0;
-
-    st->probe_packets = MAX_PROBE_PACKETS;
-
-    for(j=0; j<MAX_REORDER_DELAY+1; j++)
-      st->pts_buffer[j]= AV_NOPTS_VALUE;
-  }
-}
-
-
-
-
-
-
 ///////////////////////////////////////////////////////////////////////////
 
 
